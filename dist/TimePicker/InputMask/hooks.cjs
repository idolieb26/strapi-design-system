"use strict";Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});const t=require("react"),S=require("./utils/defer.cjs"),d=require("./utils/input.cjs"),I=require("./utils/helpers.cjs");function L(r){return t.useCallback(()=>{let e=r.current;const n=typeof window<"u"&&I.isDOMElement(e);if(!e||!n)return null;if(e.nodeName!=="INPUT"&&(e=e.querySelector("input")),!e)throw new Error("react-input-mask: inputComponent doesn't contain input node");return e},[r])}function E(r){const e=t.useRef(null),n=t.useCallback(()=>{if(e.current!==null)return;function s(){r(),e.current=S.defer(s)}s()},[r]),u=t.useCallback(()=>{S.cancelDefer(e.current),e.current=null},[]);return t.useEffect(()=>{e.current&&(u(),n())},[n,u]),t.useEffect(S.cancelDefer,[]),[n,u]}function b(r,e){const n=t.useRef({start:null,end:null}),u=L(r),s=t.useCallback(()=>{const c=u();return d.getInputSelection(c)},[u]),i=t.useCallback(()=>n.current,[]),a=t.useCallback(c=>{const p=u();!p||!d.isInputFocused(p)||(d.setInputSelection(p,c.start,c.end),n.current=s())},[u,s]),l=t.useCallback(()=>{n.current=s()},[s]),[o,f]=E(l);return t.useLayoutEffect(()=>{if(!e)return;const c=u();return c.addEventListener("focus",o),c.addEventListener("blur",f),d.isInputFocused(c)&&o(),()=>{c.removeEventListener("focus",o),c.removeEventListener("blur",f),f()}}),{getSelection:s,getLastSelection:i,setSelection:a}}function m(r,e){const n=L(r),u=t.useRef(e),s=t.useCallback(()=>n().value,[n]),i=t.useCallback(()=>u.current,[]),a=t.useCallback(l=>{u.current=l;const o=n();o&&(o.value=l)},[n]);return{getValue:s,getLastValue:i,setValue:a}}function C(r,e){const n=t.useRef(),{getSelection:u,getLastSelection:s,setSelection:i}=b(n,e),{getValue:a,getLastValue:l,setValue:o}=m(n,r);function f(){return{value:l(),selection:s()}}function c(){return{value:a(),selection:u()}}function p({value:g,selection:v}){o(g),i(v)}return{inputRef:n,getInputState:c,getLastInputState:f,setInputState:p}}function k(r){const e=t.useRef();return t.useEffect(()=>{e.current=r}),e.current}exports.useInputElement=L;exports.useInputState=C;exports.usePrevious=k;
